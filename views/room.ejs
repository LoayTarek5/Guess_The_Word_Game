<head>
  <link rel="stylesheet" href="/style/room.css" />
</head>
<div class="main-section">
  <div class="leave-modal" id="leaveModal" style="display: none">
    <div class="modal-overlay"></div>
    <div class="modal-content modal-small">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-sign-out-alt"></i>
          Leave Room?
        </div>
      </div>

      <div class="modal-body">
        <p id="leaveMessage">Are you sure you want to leave this room?</p>
        <div class="leave-warning" id="leaveWarning" style="display: none">
          <i class="fas fa-exclamation-triangle"></i>
          <span id="warningText"></span>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" id="cancelLeave">Cancel</button>
        <button class="leave-btn-modal" id="confirmLeave">
          <i class="fas fa-sign-out-alt"></i>
          Leave Room
        </button>
      </div>
    </div>
  </div>
  <div class="room-header">
    <div class="room-top">
      <a href="/lobby" class="back-button">
        <i class="fas fa-arrow-left"></i>
        Back to Lobby
      </a>
      <div class="room-code-display">
        <span class="room-code-text"></span>
        <button class="copy-btn" id="copyCode">
          <i class="fas fa-copy"></i>
        </button>
      </div>
    </div>
    <h1 class="room-title">Room Lobby</h1>
    <p class="room-info">Code: ABCDEF</p>
  </div>
  <div class="room-content">
    <div class="game-room-section">
      <div class="section-header">
        <div class="section-title">
          <i class="fas fa-users"></i>
          Game Room
        </div>
        <div class="room-settings">
          <button class="settings-btn">
            <i class="fas fa-cog"></i>
            Settings
          </button>
          <button class="invite-btn">
            <i class="fas fa-user-plus"></i>
            Invite More
          </button>
        </div>
      </div>

      <p style="color: var(--txt-color); margin-bottom: 24px; font-size: 14px">
        2/4 players • 5 letters • 6 tries
      </p>

      <h3
        style="
          font-size: 18px;
          color: var(--main-txt-color);
          margin-bottom: 16px;
        "
      >
        Players (2/4)
      </h3>

      <div class="players-grid"></div>

      <div class="game-start-section">
        <p class="start-message">
          Ready to start! Players can join during the game.
        </p>
        <button class="start-game-btn">
          <i class="fas fa-play"></i>
          Start Game
        </button>
      </div>
    </div>

    <div class="chat-section">
      <div class="chat-header">
        <i class="fas fa-comments"></i>
        <h3 class="chat-title">Room Chat</h3>
      </div>

      <div class="chat-welcome">
        Room created! Share the code with friends to invite them.
      </div>

      <div class="chat-messages" id="chatMessages">
        <div class="chat-message">
          <div class="message-sender">
            Alex
            <span class="message-time">03:11 PM</span>
          </div>
          <div class="message-text">Hey! Ready for some word games?</div>
        </div>

        <div class="chat-message own">
          <div class="message-sender">
            You
            <span class="message-time">09:51 AM</span>
          </div>
          <div class="message-text own-message">hey there</div>
        </div>
      </div>

      <div class="chat-input-container">
        <textarea
          class="chat-input"
          id="chatInput"
          rows="2"
          placeholder="Type a message..."
        ></textarea>
        <button class="chat-send-btn" id="sendBtn">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>
  <div class="invite-modal" id="inviteModal" style="display: none">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-user-plus"></i>
          Invite Friends
          <span
            id="onlineFriendsCount"
            style="font-size: 14px; color: #999; margin-left: 10px"
          ></span>
        </div>
        <button class="modal-close" id="closeModal">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body">
        <div class="search-container">
          <i class="fas fa-search"></i>
          <input
            type="text"
            id="friendSearch"
            placeholder="Search online friends..."
            class="friend-search-input"
          />
        </div>

        <div class="invite-friends-section">
          <h4>Online Friends (8)</h4>
          <div class="friends-list" id="friendsList">
            <div class="friend-item">
              <div class="friend-avatar">A</div>
              <div class="friend-info">
                <span class="friend-name">Alex</span>
                <span class="friend-status">Online</span>
              </div>
              <button class="invite-friend-btn" data-friend="Alex">
                <i class="fas fa-plus"></i>
              </button>
            </div>

            <div class="friend-item">
              <div class="friend-avatar">S</div>
              <div class="friend-info">
                <span class="friend-name">Sarah</span>
                <span class="friend-status">Online</span>
              </div>
              <button class="invite-friend-btn" data-friend="Sarah">
                <i class="fas fa-plus"></i>
              </button>
            </div>

            <div class="friend-item">
              <div class="friend-avatar">E</div>
              <div class="friend-info">
                <span class="friend-name">Emma</span>
                <span class="friend-status">Online</span>
              </div>
              <button class="invite-friend-btn" data-friend="Emma">
                <i class="fas fa-plus"></i>
              </button>
            </div>

            <div class="friend-item">
              <div class="friend-avatar">C</div>
              <div class="friend-info">
                <span class="friend-name">Chris</span>
                <span class="friend-status">Online</span>
              </div>
              <button class="invite-friend-btn" data-friend="Chris">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" id="cancelBtn">Cancel</button>
        <button class="invite-btn-modal" id="inviteBtn">Invite</button>
      </div>
    </div>
  </div>
  <div class="settings-modal" id="settingsModal" style="display: none">
    <div class="modal-overlay"></div>
    <div class="modal-content settings-modal-content">
      <div class="modal-header">
        <div class="modal-title">
          <i class="fas fa-cog"></i>
          Room Settings
        </div>
        <button class="modal-close" id="closeSettingsModal">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="modal-body settings-modal-body">
        <p class="settings-description">Modify game settings for this room</p>

        <!-- Difficulty Preview -->
        <div class="difficulty-preview">
          <div class="difficulty-header">
            <span>Difficulty Preview</span>
            <span class="difficulty-badge">Classic</span>
          </div>
          <div class="difficulty-stats">
            <div class="difficulty-stat">
              <div class="stat-number">5</div>
              <div class="stat-label">Letters</div>
            </div>
            <div class="difficulty-stat">
              <div class="stat-number">6</div>
              <div class="stat-label">Tries</div>
            </div>
            <div class="difficulty-stat">
              <div class="stat-number">2</div>
              <div class="stat-label">Max Players</div>
            </div>
            <div class="difficulty-stat">
              <div class="stat-number">US</div>
              <div class="stat-label">Language</div>
            </div>
          </div>
        </div>

        <!-- Settings Grid -->
        <div class="settings-grid">
          <!-- Word Length -->
          <div class="setting-card">
            <div class="setting-icon">
              <i class="fas fa-font"></i>
            </div>
            <div class="setting-content">
              <h4>Word Length</h4>
              <p>Choose number of letters in words</p>
              <select class="setting-select" id="wordLengthSelect">
                <option value="4">4 Letters</option>
                <option value="5" selected>5 Letters (Normal)</option>
                <option value="6">6 Letters</option>
                <option value="7">7 Letters</option>
              </select>
            </div>
          </div>

          <!-- Maximum Tries -->
          <div class="setting-card">
            <div class="setting-icon green">
              <i class="fas fa-target"></i>
            </div>
            <div class="setting-content">
              <h4>Maximum Tries</h4>
              <p>Number of guesses allowed</p>
              <div class="number-input-container">
                <button class="number-btn" id="decreaseTries">-</button>
                <span class="number-display" id="triesDisplay">6</span>
                <span class="number-label">tries</span>
                <button class="number-btn" id="increaseTries">+</button>
              </div>
            </div>
          </div>

          <!-- Max Players -->
          <div class="setting-card">
            <div class="setting-icon pink">
              <i class="fas fa-users"></i>
            </div>
            <div class="setting-content">
              <h4>Max Players</h4>
              <p>Maximum number of players</p>
              <div class="player-options">
                <button class="player-option selected" data-players="2">
                  2 Players
                </button>
                <button class="player-option" data-players="3">
                  3 Players
                </button>
                <button class="player-option" data-players="4">
                  4 Players
                </button>
              </div>
            </div>
          </div>

          <!-- Language -->
          <div class="setting-card">
            <div class="setting-icon orange">
              <i class="fas fa-globe"></i>
            </div>
            <div class="setting-content">
              <h4>Language</h4>
              <p>Game language and word list</p>
              <select class="setting-select" id="languageSelect">
                <option value="en" selected>🇺🇸 English</option>
                <option value="ar">🇦🇪 العربية (Arabic)</option>
                <option value="zh">🇨🇳 Chinese (简体中文)</option>
                <option value="de">🇩🇪 German (Deutsch)</option>
                <option value="es">🇪🇸 Spanish</option>
                <option value="fr">🇫🇷 French</option>
              </select>
            </div>
          </div>
        </div>

        <!-- Quick Presets -->
        <div class="quick-presets">
          <h4>Quick Presets</h4>
          <p>Choose from popular game configurations</p>
          <div class="preset-options">
            <button class="preset-option" data-preset="easy">
              <h5>Easy Mode</h5>
              <span>Perfect for beginners</span>
            </button>
            <button class="preset-option selected" data-preset="classic">
              <h5>Classic</h5>
              <span>Classic word game</span>
            </button>
            <button class="preset-option" data-preset="challenge">
              <h5>Challenge</h5>
              <span>For experienced players</span>
            </button>
          </div>
        </div>
      </div>

      <div class="modal-footer">
        <button class="cancel-btn" id="cancelSettingsBtn">Cancel</button>
        <button class="save-settings-btn" id="saveSettingsBtn">
          <i class="fas fa-cog"></i>
          Save Settings
        </button>
      </div>
    </div>
  </div>
</div>
<script src="/js/main.js"></script>
<script src="/js/room.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    if (window.socketManager && !window.socketManager.connected) {
      window.socketManager.connect();
    }

    // Then initialize room after DOM is ready
    document.addEventListener("DOMContentLoaded", () => {
      if (typeof initializeRoom === "function") {
        initializeRoom();
      }
    });
    window.mainUtils.initializeCommon();
    window.roomUtils.initializeRoom();
  });
</script>
